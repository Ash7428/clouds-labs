# Лабораторная работа № 3
## Задание
* Написать “плохой” CI/CD файл, который работает, но в нем есть не менее пяти “bad practices” по написанию CI/CD
* Написать “хороший” CI/CD, в котором эти плохие практики исправлены

## Bad practices
обзор на файл с плохими практиками
<img width="156" height="98" alt="image" src="https://github.com/user-attachments/assets/e6cb2dd1-6e25-4b05-8c20-fe36efedd9d9" />
Создание названия, указание триггера, после прописываю джобу с основными заданиями: **build**, 
**deploy**

В Билде определяется операционка на которой все будет выполняться. 
Отдельные шаги:
* `Checkout code` - отвечает за актуальность кода
* `Install dependencies` - устанавливает все необходимые для работы библиотеки/пакеты из файла **package.json**,
* `Run tests` - тестирование 
* `Build application` - сборка приложения и подготовка к развертыванию 
<img width="257" height="278" alt="image" src="https://github.com/user-attachments/assets/490e4d6d-9adc-4309-8ab6-6f2623835f90" />

В деплое содержится шаг **Checkout code** для получения актуального кода. Шаг  **Deploy application** содержит команду **./deploy.sh**, которая и выполняет скрипт развертывания приложения:
<img width="396" height="337" alt="image" src="https://github.com/user-attachments/assets/fda44c29-d38a-49e9-ad42-5ced5799c827" />

Плохие практикие:
1) Совмещение сборки и тестирования в одной задаче затрудняет локализацию ошибок - сложно определить, на каком именно этапе возникла проблема
2) Отсутствие кэширования зависимостей замедляет работу CI/CD, поскольку библиотеки и пакеты каждый раз устанавливаются заново
3) Не настроены зависимости между задачами **build** и **deploy**, что может привести к развёртыванию непротестированного кода, если деплой запустится после неудачных тестов
4) Неэффективное использование **actions/checkout@v3** — команда выполняется дважды, что увеличивает время работы и потребление ресурсов.
5) Отсутствие ограничений по времени выполнения этапов повышает риск зависания процессов и снижает предсказуемость работы пайплайна.

## Good practices
1) Чтобы исправить первую плохую практику, я разделила сборку и тестирование на отдельные этапы. Это сделало код понятнее и упростило поиск ошибок. Также повысилась гибкость — теперь проще добавлять, менять или повторно использовать этапы в пайплайне.
   <img width="676" height="709" alt="image" src="https://github.com/user-attachments/assets/c07a5dce-eae4-46ea-b999-8cdb46c0e093" />

   
2) Добавила кэширование npm-зависимостей. Теперь зависимости не скачиваются каждый раз заново, если не менялся файл package-lock.json. Это ускорило работу CI/CD и сэкономило ресурсы.
   <img width="594" height="174" alt="image" src="https://github.com/user-attachments/assets/fc75b0e8-c210-4328-8bae-33fad551f58d" />

3) Настроила зависимости между этапами: тесты запускаются только после успешной сборки, а деплой — только после прохождения всех тестов. Это исключило развёртывание непроверенного кода.

<img width="208" height="73" alt="image" src="https://github.com/user-attachments/assets/87b3d46b-909a-4c7c-90da-f82b2d235c0c" />
<img width="209" height="72" alt="image" src="https://github.com/user-attachments/assets/410e7961-85c8-41a2-b45e-d5bf18548677" />
4) В исправленной версии actions/checkout@v3 вызывается только один раз при сборке. Благодаря зависимостям между этапами удалось избежать повторных загрузок кода, что ускорило выполнение пайплайна

5) Для каждого этапа установлено ограничение времени в 30 минут (timeout-minutes: 30). Теперь можно контролировать длительность выполнения и предотвращать зависания. Это повышает надёжность и позволяет быстрее реагировать на сбои.
<img width="242" height="85" alt="image" src="https://github.com/user-attachments/assets/a27ad3e4-169f-406f-8526-54d84aa54f46" />
<img width="245" height="99" alt="image" src="https://github.com/user-attachments/assets/54a1f4ea-6985-4f7f-93f6-6eadc85c7577" />
<img width="213" height="103" alt="image" src="https://github.com/user-attachments/assets/5d5a61c5-1d43-46b9-99f9-e0ad5d8bd991" />

# Запуск пайплайнов

<img width="1920" height="643" alt="image" src="https://github.com/user-attachments/assets/03e99120-04e5-4597-b200-62dd04f70a11" />


<img width="1920" height="780" alt="image" src="https://github.com/user-attachments/assets/3a6787bd-e6ad-4fe3-817e-747c69995674" />

<img width="1913" height="795" alt="image" src="https://github.com/user-attachments/assets/7476e80a-07d4-4761-a5f7-81b704205431" />
